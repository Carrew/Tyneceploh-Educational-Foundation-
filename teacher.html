<!DOCTYPE html><html>
<head>
  <title>Teacher Portal</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #f9f9f9; }
    .container { margin-bottom: 20px; padding: 15px; border: 1px solid #ddd; background: #fff; border-radius: 8px; }
    .blue { color: blue; }
    .red { color: red; }
    input, select, button { margin: 5px; padding: 5px; }
    .gradeForm { margin-top: 10px; }
  </style>
</head>
<body>
  <h2>Welcome, Teacher</h2>
  <div id="teacherClass">Class: <strong id="classLabel"></strong></div>
  <button onclick="addStudent()">Add Student</button>
  <button onclick="addSubject()">Add Subject</button>
  <div id="studentList"></div>  <script>
    const teacherClass = localStorage.getItem("teacherClass") || "Grade 6";
    document.getElementById("classLabel").innerText = teacherClass;

    function addStudent() {
      const container = document.createElement("div");
      container.className = "container";
      container.innerHTML = `
        <label>Student Name: <input class="studentName" /></label><br>
        <div class="grades"></div>
        <form class="gradeForm"></form>
        <button onclick="submitGrades(this)" type="button">Submit Grades</button>
      `;
      document.getElementById("studentList").appendChild(container);
    }

    function addSubject() {
      const containers = document.querySelectorAll(".container");
      containers.forEach(container => {
        const form = container.querySelector(".gradeForm");
        const row = document.createElement("div");
        row.innerHTML = `
          <input placeholder="Subject" />
          <input type="number" placeholder="Score" />
        `;
        form.appendChild(row);
      });
    }

    function submitGrades(button) {
      const container = button.parentElement;
      const form = container.querySelector(".gradeForm");
      const gradesDiv = container.querySelector(".grades");
      const rows = form.querySelectorAll("div");
      let total = 0;
      let count = 0;
      const grades = [];

      rows.forEach(row => {
        const inputs = row.querySelectorAll("input");
        const subject = inputs[0].value.trim();
        const score = parseInt(inputs[1].value);
        if (subject && !isNaN(score)) {
          grades.push({ subject, score });
          total += score;
          count++;
          inputs[0].disabled = true;
          inputs[1].disabled = true;
          inputs[1].className = score >= 70 ? "blue" : "red";
        }
      });

      const avg = count ? (total / count).toFixed(2) : "0.00";

      const studentName = container.querySelector(".studentName").value.trim().toLowerCase();
      const key = `grades_${teacherClass}_${studentName}`;

      const gradeData = {
        studentName,
        class: teacherClass,
        grades,
        average: avg,
        approved: false
      };

      localStorage.setItem(key, JSON.stringify(gradeData));

      const existingAvg = gradesDiv.querySelector(".averageDisplay");
      if (existingAvg) existingAvg.remove();

      const averageDisplay = document.createElement("div");
      averageDisplay.className = "averageDisplay";
      averageDisplay.style.marginTop = "10px";
      averageDisplay.innerHTML = `<strong>Average:</strong> ${avg}`;
      gradesDiv.appendChild(averageDisplay);

      button.disabled = true;
    }
  <script src="check_teacher_login.js"></script>
</body>
</html>
